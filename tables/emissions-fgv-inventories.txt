CREATE EXTERNAL TABLE uati.emissions_fgv_inventories (
    `id`                                          int,
    `responsible_name`                            string,
    `responsible_email`                           string,
    `inventory_type`                              int,
    `organization_id`                             int,
    `cycle_id`                                    int,
    `created_at`                                  timestamp,
    `updated_at`                                  timestamp,
    `verifier_id`                                 int,
    `verifier_organization_id`                    int,
    `legacy_id`                                   int,
    `verified`                                    boolean,
    `organogram_id`                               int,
    `equity_interest_report`                      boolean,
    `unreported_sources`                          string,
    `status`                                      int,
    `declaration_file_id`                         int,
    `pdf_url`                                     string,
    `purchase_choice_approach`                    boolean,
    `organization`                                struct<
                                                        `id`:int,
                                                        `name`:string,
                                                        `cnpj`:string,
                                                        `phone`:string,
                                                        `address`:string,
                                                        `district`:string,
                                                        `zipcode`:string,
                                                        `city`:string,
                                                        `about`:string,
                                                        `created_at`:string,    
                                                        `updated_at`:string,
                                                        `sector_id`:int,
                                                        `subsector_id`:int,
                                                        `state_id`:int,
                                                        `number`:string,
                                                        `complement`:string,
                                                        `legacy_id`:int,
                                                        `legal_name`:string,
                                                        `logo_id`:int,
                                                        `vector_logo_id`:int
                                                        >,
    `organization_cycle`                          string,
    `link`                                        string,
    `cycle`                                       string,
    `organogram`                                  string,
    `logo`                                        string,
    `emissions`                                   string,
    `tree`                                        string,
    `controlled_children_ids`                     string,
    `operational_limit_emissions`                 string,
    `declaration_file`                            string,
    `badge`                                       string,
    `coordinates`                                 string
)
ROW FORMAT SERDE 'org.apache.hive.hcatalog.data.JsonSerDe'
WITH SERDEPROPERTIES (
'serialization.format' = '1'
) LOCATION 's3://uati-case-fgv/emissions-fgv-inv/'
 
 
 `id`                                          int,
    `responsible_name`                            string,
    `responsible_email`                           string,
    `inventory_type`                              int,
    `organization_id`                             int,
    `cycle_id`                                    int,
    `created_at`                                  timestamp,
    `updated_at`                                  timestamp,
    `verifier_id`                                 int,
    `verifier_organization_id`                    int,
    `legacy_id`                                   int,
    `verified`                                    boolean,
    `organogram_id`                               int,
    `equity_interest_report`                      boolean,
    `unreported_sources`                          string,
    `status`                                      int,
    `declaration_file_id`                         int,
    `pdf_url`                                     string,
    `purchase_choice_approach`                    boolean,
    `organization`                                struct<
                                                        `id`:int,
                                                        `name`:string,
                                                        `cnpj`:string,
                                                        `phone`:string,
                                                        `address`:string,
                                                        `district`:string,
                                                        `zipcode`:string,
                                                        `city`:string,
                                                        `about`:string,
                                                        `created_at`:string,    
                                                        `updated_at`:string,
                                                        `sector_id`:int,
                                                        `subsector_id`:int,
                                                        `state_id`:int,
                                                        `number`:string,
                                                        `complement`:string,
                                                        `legacy_id`:int,
                                                        `legal_name`:string,
                                                        `logo_id`:int,
                                                        `vector_logo_id`:int
                                                        >,
    `organization_cycle`                          dict,
    `link`                                        dict,
    `cycle`                                       dict,
    `organogram`                                  dict,
    `logo`                                        string,
    `emissions`                                   list<dict>,
    `tree`                                        dict,
    `controlled_children_ids`                     list,
    `operational_limit_emissions`                 list<dict>,
    `declaration_file`                            dict,
    `badge`                                       string,
    `coordinates`                                 list